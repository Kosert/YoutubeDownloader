window.onload=function(){function e(){if(""===i.value)d="",a();else if(""!==i.value&&d!==i.value){n();var e="url="+(d=i.value);xmlhttp=new XMLHttpRequest,xmlhttp.open("POST","/youtube/validateURL",!0),xmlhttp.onreadystatechange=function(){4==xmlhttp.readyState&&200==xmlhttp.status&&("true"===xmlhttp.responseText?s():a())},xmlhttp.send(e)}}function t(){setTimeout(e,0)}function n(){i.classList.add("loading"),i.classList.remove("is-valid"),i.classList.remove("is-invalid"),l.classList.add("btn-secondary"),l.classList.remove("btn-primary"),l.disabled=!0}function s(){i.classList.remove("loading"),i.classList.add("is-valid"),l.classList.add("btn-primary"),l.classList.remove("btn-secondary"),l.disabled=!1}function a(){i.classList.remove("loading"),i.classList.add("is-invalid"),l.classList.add("btn-secondary"),l.classList.remove("btn-primary"),l.disabled=!0}var i=document.getElementById("input-url"),l=document.getElementById("button-download"),d="";i.addEventListener("keyup",t),i.addEventListener("paste",t),l.addEventListener("click",function(){var e=document.getElementById("formats"),t=e.getElementsByTagName("tbody")[0],n=document.createElement("tbody"),s=document.createElement("div");s.classList.add("progress");var a=document.createElement("div");a.classList.add("progress-bar","progress-bar-striped","progress-bar-animated","w-100"),s.appendChild(a);var i=n.insertRow(0).insertCell();i.style="height: 50px;",i.classList.add("align-middle"),i.appendChild(s),i.colSpan="5",e.replaceChild(n,t),e.hidden=!1;var l="url="+d;xmlhttp=new XMLHttpRequest,xmlhttp.open("POST","/youtube/getInfo",!0),xmlhttp.onreadystatechange=function(){if(4==xmlhttp.readyState&&200==xmlhttp.status){var e=JSON.parse(xmlhttp.responseText);if(e.error){n.deleteRow(0);var t=n.insertRow(0).insertCell();t.colSpan="5",t.classList.add("alert","alert-danger"),t.innerText="Error: "+e.error}else{n.deleteRow(0);for(f of e){var s=n.insertRow(n.rows.length);s.insertCell().innerHTML=f.encoding?f.encoding:"<b>NO VIDEO</b>",s.insertCell().innerHTML=f.audioEncoding?f.audioEncoding:"<b>NO AUDIO</b>",s.insertCell().innerHTML=f.container,s.insertCell().innerHTML=f.encoding?f.resolution+(f.fps?" "+f.fps+"fps":""):f.audioBitrate+" kbps";var a=document.createElement("a");a.href=f.url;var i=document.createTextNode("Click here");a.appendChild(i),a.title="Click here",s.insertCell().appendChild(a)}}}},xmlhttp.send(l)}),console.log("Init completed.")};